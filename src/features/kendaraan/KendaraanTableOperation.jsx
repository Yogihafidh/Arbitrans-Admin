import { useSearchParams } from "react-router";
import { useMemo } from "react";

import Button from "../../ui/Button";
import ButtonDropdown from "../../ui/ButtonDropdown";
import Filter from "../../ui/Filter";
import Modal from "../../ui/Modal";
import InputSearch from "../../ui/InputSearch";
import KendaraanForm from "./KendaraanForm";

function KendaraanTableOperation() {
  // useMemo to avoid re-creating icons on every render
  const iconActive = useMemo(
    () => (
      <svg
        width="16"
        height="16"
        viewBox="0 0 16 16"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M2.64622 9.64621L7.64622 4.64622C7.69265 4.59973 7.7478 4.56285 7.8085 4.53769C7.8692 4.51252 7.93426 4.49957 7.99997 4.49957C8.06567 4.49957 8.13074 4.51252 8.19144 4.53769C8.25214 4.56285 8.30728 4.59973 8.35372 4.64622L13.3537 9.64622C13.4475 9.74004 13.5002 9.86728 13.5002 9.99997C13.5002 10.1326 13.4475 10.2599 13.3537 10.3537C13.2599 10.4475 13.1326 10.5002 13 10.5002C12.8673 10.5002 12.74 10.4475 12.6462 10.3537L7.99997 5.70684L3.35372 10.3537C3.30726 10.4002 3.25211 10.437 3.19141 10.4622C3.13072 10.4873 3.06566 10.5002 2.99997 10.5002C2.93427 10.5002 2.86921 10.4873 2.80852 10.4622C2.74782 10.437 2.69267 10.4002 2.64622 10.3537C2.59976 10.3073 2.56291 10.2521 2.53777 10.1914C2.51263 10.1307 2.49969 10.0657 2.49969 9.99997C2.49969 9.93427 2.51263 9.86921 2.53777 9.80852C2.56291 9.74782 2.59976 9.69267 2.64622 9.64621Z"
          fill="currentColor"
        />
      </svg>
    ),
    [],
  );
  const iconPasif = useMemo(
    () => (
      <svg
        width="16"
        height="16"
        viewBox="0 0 16 16"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M13.3538 6.35378L8.35378 11.3538C8.30735 11.4003 8.2522 11.4372 8.1915 11.4623C8.13081 11.4875 8.06574 11.5004 8.00003 11.5004C7.93433 11.5004 7.86926 11.4875 7.80856 11.4623C7.74786 11.4372 7.69272 11.4003 7.64628 11.3538L2.64628 6.35378C2.55246 6.25996 2.49976 6.13272 2.49976 6.00003C2.49976 5.86735 2.55246 5.7401 2.64628 5.64628C2.7401 5.55246 2.86735 5.49976 3.00003 5.49976C3.13272 5.49976 3.25996 5.55246 3.35378 5.64628L8.00003 10.2932L12.6463 5.64628C12.6927 5.59983 12.7479 5.56298 12.8086 5.53784C12.8693 5.5127 12.9343 5.49976 13 5.49976C13.0657 5.49976 13.1308 5.5127 13.1915 5.53784C13.2522 5.56298 13.3073 5.59983 13.3538 5.64628C13.4002 5.69274 13.4371 5.74789 13.4622 5.80859C13.4874 5.86928 13.5003 5.93434 13.5003 6.00003C13.5003 6.06573 13.4874 6.13079 13.4622 6.19148C13.4371 6.25218 13.4002 6.30733 13.3538 6.35378Z"
          fill="currentColor"
        />
      </svg>
    ),
    [],
  );

  const statusOptions = useMemo(
    () => [
      { label: "Tersedia", value: "Tersedia" },
      { label: "Disewa", value: "Disewa" },
      { label: "Pending", value: "Pending" },
    ],
    [],
  );

  // Get the current status from URL search params
  const [searchparams] = useSearchParams();
  const status = searchparams.get("status") || "Tersedia";

  return (
    <div className="flex items-center justify-between">
      <div className="w-1/4">
        <InputSearch
          placeholder="Cari nama atau Tipe kendaraan..."
          icon={
            <svg
              width="16"
              height="16"
              viewBox="0 0 14 14"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M13.3536 12.6464L10.2243 9.51764C11.1313 8.42871 11.5836 7.03201 11.487 5.6181C11.3905 4.20419 10.7526 2.88193 9.70599 1.92637C8.65938 0.970822 7.28468 0.455551 5.86784 0.487751C4.451 0.519951 3.10112 1.09714 2.09901 2.09926C1.0969 3.10137 0.519707 4.45125 0.487507 5.86808C0.455307 7.28492 0.970578 8.65963 1.92613 9.70623C2.88168 10.7528 4.20395 11.3908 5.61786 11.4873C7.03177 11.5838 8.42846 11.1315 9.5174 10.2245L12.6461 13.3539C12.6926 13.4003 12.7478 13.4372 12.8085 13.4623C12.8691 13.4875 12.9342 13.5004 12.9999 13.5004C13.0656 13.5004 13.1307 13.4875 13.1913 13.4623C13.252 13.4372 13.3072 13.4003 13.3536 13.3539C13.4001 13.3074 13.437 13.2523 13.4621 13.1916C13.4872 13.1309 13.5002 13.0658 13.5002 13.0001C13.5002 12.9344 13.4872 12.8694 13.4621 12.8087C13.437 12.748 13.4001 12.6928 13.3536 12.6464ZM1.4999 6.00014C1.4999 5.11013 1.76382 4.2401 2.25829 3.50008C2.75275 2.76006 3.45556 2.18328 4.27782 1.84268C5.10009 1.50209 6.00489 1.41298 6.8778 1.58661C7.75072 1.76024 8.55254 2.18883 9.18188 2.81816C9.81122 3.4475 10.2398 4.24932 10.4134 5.12224C10.5871 5.99515 10.498 6.89995 10.1574 7.72222C9.81676 8.54449 9.23999 9.24729 8.49996 9.74176C7.75994 10.2362 6.88991 10.5001 5.9999 10.5001C4.80683 10.4988 3.66301 10.0243 2.81938 9.18066C1.97575 8.33704 1.50122 7.19321 1.4999 6.00014Z"
                fill="currentColor"
              />
            </svg>
          }
        />
      </div>

      <div className="flex items-center gap-4">
        <Modal>
          <Modal.Open opens="kendaraan-form">
            <Button
              text="Tambah Kendaraan"
              type="primary"
              leftIcon={
                <svg
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M19.75 11H12.5V3.75C12.5 3.33579 12.1642 3 11.75 3C11.3358 3 11 3.33579 11 3.75V11H3.75C3.33579 11 3 11.3358 3 11.75C3 12.1642 3.33579 12.5 3.75 12.5H11V19.75C11 20.1642 11.3358 20.5 11.75 20.5C12.1642 20.5 12.5 20.1642 12.5 19.75V12.5H19.75C20.1642 12.5 20.5 12.1642 20.5 11.75C20.5 11.3358 20.1642 11 19.75 11Z"
                    fill="currentColor"
                  />
                </svg>
              }
            />
          </Modal.Open>
          <Modal.Window name="kendaraan-form">
            <KendaraanForm />
          </Modal.Window>
        </Modal>

        <ButtonDropdown
          text={status}
          buttonName="filter-status"
          iconActive={iconActive}
          iconPasif={iconPasif}
        >
          <Filter
            className="absolute top-14 right-0.5 z-50 bg-white"
            type="list"
            options={statusOptions}
          />
        </ButtonDropdown>
      </div>
    </div>
  );
}

export default KendaraanTableOperation;
